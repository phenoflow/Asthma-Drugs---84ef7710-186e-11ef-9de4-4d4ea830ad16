# Tim Doran, Evangelos Kontopantelis, Jose M Valderas, Stephen Campbell, Martin Roland, Chris Salisbury, David Reeves, 2024.

import sys, csv, re

codes = [{"code":"8609002","system":"gprdproduct"},{"code":"12485001","system":"gprdproduct"},{"code":"13265001","system":"gprdproduct"},{"code":"1559009","system":"gprdproduct"},{"code":"4061002","system":"gprdproduct"},{"code":"3972009","system":"gprdproduct"},{"code":"3265002","system":"gprdproduct"},{"code":"10764001","system":"gprdproduct"},{"code":"5413009","system":"gprdproduct"},{"code":"2220001","system":"gprdproduct"},{"code":"1557009","system":"gprdproduct"},{"code":"2290009","system":"gprdproduct"},{"code":"996001","system":"gprdproduct"},{"code":"14564005","system":"gprdproduct"},{"code":"1193002","system":"gprdproduct"},{"code":"836001","system":"gprdproduct"},{"code":"6649001","system":"gprdproduct"},{"code":"3195007","system":"gprdproduct"},{"code":"4016009","system":"gprdproduct"},{"code":"13257001","system":"gprdproduct"},{"code":"8665002","system":"gprdproduct"},{"code":"5543001","system":"gprdproduct"},{"code":"6267001","system":"gprdproduct"},{"code":"9906001","system":"gprdproduct"},{"code":"1898001","system":"gprdproduct"},{"code":"7157003","system":"gprdproduct"},{"code":"34002","system":"gprdproduct"},{"code":"8782001","system":"gprdproduct"},{"code":"7288001","system":"gprdproduct"},{"code":"5958002","system":"gprdproduct"},{"code":"5743009","system":"gprdproduct"},{"code":"3064010","system":"gprdproduct"},{"code":"13470001","system":"gprdproduct"},{"code":"10723003","system":"gprdproduct"},{"code":"2822009","system":"gprdproduct"},{"code":"5592001","system":"gprdproduct"},{"code":"5557002","system":"gprdproduct"},{"code":"3394009","system":"gprdproduct"},{"code":"9699001","system":"gprdproduct"},{"code":"10770001","system":"gprdproduct"},{"code":"602009","system":"gprdproduct"},{"code":"7233001","system":"gprdproduct"},{"code":"13272001","system":"gprdproduct"},{"code":"1047001","system":"gprdproduct"},{"code":"6942002","system":"gprdproduct"},{"code":"13803001","system":"gprdproduct"},{"code":"5758009","system":"gprdproduct"},{"code":"121002","system":"gprdproduct"},{"code":"1340001","system":"gprdproduct"},{"code":"1190001","system":"gprdproduct"},{"code":"14171001","system":"gprdproduct"},{"code":"106002","system":"gprdproduct"},{"code":"1144007","system":"gprdproduct"},{"code":"865003","system":"gprdproduct"},{"code":"12019001","system":"gprdproduct"},{"code":"9769005","system":"gprdproduct"},{"code":"2327002","system":"gprdproduct"},{"code":"3438009","system":"gprdproduct"},{"code":"6415001","system":"gprdproduct"},{"code":"86002","system":"gprdproduct"},{"code":"10216001","system":"gprdproduct"},{"code":"9583003","system":"gprdproduct"},{"code":"5739001","system":"gprdproduct"},{"code":"12008002","system":"gprdproduct"},{"code":"8892001","system":"gprdproduct"},{"code":"2993011","system":"gprdproduct"},{"code":"4787002","system":"gprdproduct"},{"code":"4785003","system":"gprdproduct"},{"code":"7154002","system":"gprdproduct"},{"code":"9031001","system":"gprdproduct"},{"code":"5440001","system":"gprdproduct"},{"code":"5150002","system":"gprdproduct"},{"code":"5740001","system":"gprdproduct"},{"code":"2986009","system":"gprdproduct"},{"code":"7363001","system":"gprdproduct"},{"code":"12930001","system":"gprdproduct"},{"code":"2827001","system":"gprdproduct"},{"code":"6058001","system":"gprdproduct"},{"code":"1828007","system":"gprdproduct"},{"code":"3371009","system":"gprdproduct"},{"code":"606009","system":"gprdproduct"},{"code":"14568005","system":"gprdproduct"},{"code":"9583001","system":"gprdproduct"},{"code":"12070001","system":"gprdproduct"},{"code":"5441002","system":"gprdproduct"},{"code":"34001","system":"gprdproduct"},{"code":"6933003","system":"gprdproduct"},{"code":"12019003","system":"gprdproduct"},{"code":"11519001","system":"gprdproduct"},{"code":"1776003","system":"gprdproduct"},{"code":"7280001","system":"gprdproduct"},{"code":"3445002","system":"gprdproduct"},{"code":"2514001","system":"gprdproduct"},{"code":"8715002","system":"gprdproduct"},{"code":"7105001","system":"gprdproduct"},{"code":"6016003","system":"gprdproduct"},{"code":"5581001","system":"gprdproduct"},{"code":"6915002","system":"gprdproduct"},{"code":"3971009","system":"gprdproduct"},{"code":"5395001","system":"gprdproduct"},{"code":"4813002","system":"gprdproduct"},{"code":"6673007","system":"gprdproduct"},{"code":"12723001","system":"gprdproduct"},{"code":"4811001","system":"gprdproduct"},{"code":"6915001","system":"gprdproduct"},{"code":"11904001","system":"gprdproduct"},{"code":"2757001","system":"gprdproduct"},{"code":"6268002","system":"gprdproduct"},{"code":"12843001","system":"gprdproduct"},{"code":"58005","system":"gprdproduct"},{"code":"13804001","system":"gprdproduct"},{"code":"14174001","system":"gprdproduct"},{"code":"602011","system":"gprdproduct"},{"code":"11530003","system":"gprdproduct"},{"code":"1193001","system":"gprdproduct"},{"code":"12011001","system":"gprdproduct"},{"code":"3164009","system":"gprdproduct"},{"code":"11530001","system":"gprdproduct"},{"code":"5508002","system":"gprdproduct"},{"code":"4756009","system":"gprdproduct"},{"code":"9365001","system":"gprdproduct"},{"code":"13244001","system":"gprdproduct"},{"code":"1382001","system":"gprdproduct"},{"code":"8803005","system":"gprdproduct"},{"code":"6314002","system":"gprdproduct"},{"code":"13118001","system":"gprdproduct"},{"code":"3267001","system":"gprdproduct"},{"code":"11901001","system":"gprdproduct"},{"code":"3853009","system":"gprdproduct"},{"code":"5137001","system":"gprdproduct"},{"code":"12019002","system":"gprdproduct"},{"code":"2133009","system":"gprdproduct"},{"code":"4815001","system":"gprdproduct"},{"code":"14446001","system":"gprdproduct"},{"code":"9847005","system":"gprdproduct"},{"code":"6058003","system":"gprdproduct"},{"code":"2338002","system":"gprdproduct"},{"code":"2241002","system":"gprdproduct"},{"code":"1667002","system":"gprdproduct"},{"code":"3234009","system":"gprdproduct"},{"code":"8292005","system":"gprdproduct"},{"code":"4061003","system":"gprdproduct"},{"code":"2608001","system":"gprdproduct"},{"code":"5593007","system":"gprdproduct"},{"code":"9241001","system":"gprdproduct"},{"code":"11045001","system":"gprdproduct"},{"code":"14948001","system":"gprdproduct"},{"code":"11843001","system":"gprdproduct"},{"code":"10724001","system":"gprdproduct"},{"code":"3266001","system":"gprdproduct"},{"code":"4926001","system":"gprdproduct"},{"code":"1898002","system":"gprdproduct"},{"code":"1023001","system":"gprdproduct"},{"code":"6379007","system":"gprdproduct"},{"code":"11647002","system":"gprdproduct"},{"code":"6314001","system":"gprdproduct"},{"code":"6268001","system":"gprdproduct"},{"code":"5466001","system":"gprdproduct"},{"code":"1409002","system":"gprdproduct"},{"code":"6700009","system":"gprdproduct"},{"code":"4812002","system":"gprdproduct"},{"code":"2901010","system":"gprdproduct"},{"code":"1285001","system":"gprdproduct"},{"code":"4888001","system":"gprdproduct"},{"code":"8026001","system":"gprdproduct"},{"code":"5467002","system":"gprdproduct"},{"code":"9846005","system":"gprdproduct"},{"code":"10137001","system":"gprdproduct"},{"code":"1024001","system":"gprdproduct"},{"code":"2259005","system":"gprdproduct"},{"code":"8506001","system":"gprdproduct"},{"code":"796001","system":"gprdproduct"},{"code":"13430001","system":"gprdproduct"},{"code":"4341007","system":"gprdproduct"},{"code":"2744009","system":"gprdproduct"},{"code":"4936002","system":"gprdproduct"},{"code":"3265001","system":"gprdproduct"},{"code":"12561001","system":"gprdproduct"},{"code":"1780009","system":"gprdproduct"},{"code":"8380002","system":"gprdproduct"},{"code":"3307009","system":"gprdproduct"},{"code":"11648002","system":"gprdproduct"},{"code":"12872001","system":"gprdproduct"},{"code":"5441001","system":"gprdproduct"},{"code":"8607001","system":"gprdproduct"},{"code":"13679001","system":"gprdproduct"},{"code":"602010","system":"gprdproduct"},{"code":"4815002","system":"gprdproduct"},{"code":"8921001","system":"gprdproduct"},{"code":"14173001","system":"gprdproduct"},{"code":"9581001","system":"gprdproduct"},{"code":"2127002","system":"gprdproduct"},{"code":"166003","system":"gprdproduct"},{"code":"4789001","system":"gprdproduct"},{"code":"9412001","system":"gprdproduct"},{"code":"3834009","system":"gprdproduct"},{"code":"606010","system":"gprdproduct"},{"code":"69001","system":"gprdproduct"},{"code":"8679001","system":"gprdproduct"},{"code":"9582003","system":"gprdproduct"},{"code":"11475003","system":"gprdproduct"},{"code":"11565003","system":"gprdproduct"},{"code":"620001","system":"gprdproduct"},{"code":"8636001","system":"gprdproduct"},{"code":"7234001","system":"gprdproduct"},{"code":"1193003","system":"gprdproduct"},{"code":"5544002","system":"gprdproduct"},{"code":"3268001","system":"gprdproduct"},{"code":"3322001","system":"gprdproduct"},{"code":"1191001","system":"gprdproduct"},{"code":"13802001","system":"gprdproduct"},{"code":"5708009","system":"gprdproduct"},{"code":"14566005","system":"gprdproduct"},{"code":"12013001","system":"gprdproduct"},{"code":"13269001","system":"gprdproduct"},{"code":"2835002","system":"gprdproduct"},{"code":"11530002","system":"gprdproduct"},{"code":"1018001","system":"gprdproduct"},{"code":"1112001","system":"gprdproduct"},{"code":"5543003","system":"gprdproduct"},{"code":"85001","system":"gprdproduct"},{"code":"1286001","system":"gprdproduct"},{"code":"2195001","system":"gprdproduct"},{"code":"172007","system":"gprdproduct"},{"code":"5927009","system":"gprdproduct"},{"code":"13255001","system":"gprdproduct"},{"code":"2914001","system":"gprdproduct"},{"code":"14170001","system":"gprdproduct"},{"code":"5152002","system":"gprdproduct"},{"code":"1667001","system":"gprdproduct"},{"code":"6697001","system":"gprdproduct"},{"code":"120001","system":"gprdproduct"},{"code":"14954001","system":"gprdproduct"},{"code":"11511001","system":"gprdproduct"},{"code":"4786001","system":"gprdproduct"},{"code":"1832011","system":"gprdproduct"},{"code":"10761001","system":"gprdproduct"},{"code":"1404001","system":"gprdproduct"},{"code":"468001","system":"gprdproduct"},{"code":"8596001","system":"gprdproduct"},{"code":"5056003","system":"gprdproduct"},{"code":"4017009","system":"gprdproduct"},{"code":"14209001","system":"gprdproduct"},{"code":"2066009","system":"gprdproduct"},{"code":"12016001","system":"gprdproduct"},{"code":"5564001","system":"gprdproduct"},{"code":"13243001","system":"gprdproduct"},{"code":"12505001","system":"gprdproduct"},{"code":"5056002","system":"gprdproduct"},{"code":"5372001","system":"gprdproduct"},{"code":"833001","system":"gprdproduct"},{"code":"11694002","system":"gprdproduct"},{"code":"12071001","system":"gprdproduct"},{"code":"11565002","system":"gprdproduct"},{"code":"5508001","system":"gprdproduct"},{"code":"2208009","system":"gprdproduct"},{"code":"1899009","system":"gprdproduct"},{"code":"14563005","system":"gprdproduct"},{"code":"4837009","system":"gprdproduct"},{"code":"795001","system":"gprdproduct"},{"code":"996003","system":"gprdproduct"},{"code":"6845001","system":"gprdproduct"},{"code":"1397001","system":"gprdproduct"},{"code":"86001","system":"gprdproduct"},{"code":"1047003","system":"gprdproduct"},{"code":"11042001","system":"gprdproduct"},{"code":"6943001","system":"gprdproduct"},{"code":"3357009","system":"gprdproduct"},{"code":"8429001","system":"gprdproduct"},{"code":"2993010","system":"gprdproduct"},{"code":"11166002","system":"gprdproduct"},{"code":"5152003","system":"gprdproduct"},{"code":"14562005","system":"gprdproduct"},{"code":"12013002","system":"gprdproduct"},{"code":"3264001","system":"gprdproduct"},{"code":"6453009","system":"gprdproduct"},{"code":"8802005","system":"gprdproduct"},{"code":"5055002","system":"gprdproduct"},{"code":"7104001","system":"gprdproduct"},{"code":"3435009","system":"gprdproduct"},{"code":"5367007","system":"gprdproduct"},{"code":"2301001","system":"gprdproduct"},{"code":"2730005","system":"gprdproduct"},{"code":"11737001","system":"gprdproduct"},{"code":"3207009","system":"gprdproduct"},{"code":"5706009","system":"gprdproduct"},{"code":"7526002","system":"gprdproduct"},{"code":"11165001","system":"gprdproduct"},{"code":"6818001","system":"gprdproduct"},{"code":"5152001","system":"gprdproduct"},{"code":"8150001","system":"gprdproduct"},{"code":"1376001","system":"gprdproduct"},{"code":"11509002","system":"gprdproduct"},{"code":"6942001","system":"gprdproduct"},{"code":"8677002","system":"gprdproduct"},{"code":"2701005","system":"gprdproduct"},{"code":"11474002","system":"gprdproduct"},{"code":"4836009","system":"gprdproduct"},{"code":"9057001","system":"gprdproduct"},{"code":"5581002","system":"gprdproduct"},{"code":"8677001","system":"gprdproduct"},{"code":"6560001","system":"gprdproduct"},{"code":"3888003","system":"gprdproduct"},{"code":"3414009","system":"gprdproduct"},{"code":"5466003","system":"gprdproduct"},{"code":"1404002","system":"gprdproduct"},{"code":"7334001","system":"gprdproduct"},{"code":"14172001","system":"gprdproduct"},{"code":"1403002","system":"gprdproduct"},{"code":"603010","system":"gprdproduct"},{"code":"4013002","system":"gprdproduct"},{"code":"3357010","system":"gprdproduct"},{"code":"12871001","system":"gprdproduct"},{"code":"12009002","system":"gprdproduct"},{"code":"1384001","system":"gprdproduct"},{"code":"5138001","system":"gprdproduct"},{"code":"373001","system":"gprdproduct"},{"code":"7714003","system":"gprdproduct"},{"code":"4506001","system":"gprdproduct"},{"code":"7555001","system":"gprdproduct"},{"code":"1667003","system":"gprdproduct"},{"code":"3445003","system":"gprdproduct"},{"code":"2286001","system":"gprdproduct"},{"code":"8063001","system":"gprdproduct"},{"code":"10723002","system":"gprdproduct"},{"code":"4813001","system":"gprdproduct"},{"code":"949002","system":"gprdproduct"},{"code":"5616002","system":"gprdproduct"},{"code":"11791005","system":"gprdproduct"},{"code":"122002","system":"gprdproduct"},{"code":"3966003","system":"gprdproduct"},{"code":"4788002","system":"gprdproduct"},{"code":"4814003","system":"gprdproduct"},{"code":"2286002","system":"gprdproduct"},{"code":"5507001","system":"gprdproduct"},{"code":"6043001","system":"gprdproduct"},{"code":"1722001","system":"gprdproduct"},{"code":"5411009","system":"gprdproduct"},{"code":"11474001","system":"gprdproduct"},{"code":"7099002","system":"gprdproduct"},{"code":"5274001","system":"gprdproduct"},{"code":"3064011","system":"gprdproduct"},{"code":"8715001","system":"gprdproduct"},{"code":"2703005","system":"gprdproduct"},{"code":"3322002","system":"gprdproduct"},{"code":"6697002","system":"gprdproduct"},{"code":"3973009","system":"gprdproduct"},{"code":"3373011","system":"gprdproduct"},{"code":"2836002","system":"gprdproduct"},{"code":"15469005","system":"gprdproduct"},{"code":"3510007","system":"gprdproduct"},{"code":"8582001","system":"gprdproduct"},{"code":"375001","system":"gprdproduct"},{"code":"7154001","system":"gprdproduct"},{"code":"5507002","system":"gprdproduct"},{"code":"9845005","system":"gprdproduct"},{"code":"5774009","system":"gprdproduct"},{"code":"86003","system":"gprdproduct"},{"code":"6069001","system":"gprdproduct"},{"code":"11167001","system":"gprdproduct"},{"code":"2515001","system":"gprdproduct"},{"code":"14176001","system":"gprdproduct"},{"code":"14567005","system":"gprdproduct"},{"code":"7898001","system":"gprdproduct"},{"code":"106003","system":"gprdproduct"},{"code":"2746003","system":"gprdproduct"},{"code":"1898003","system":"gprdproduct"},{"code":"12398001","system":"gprdproduct"},{"code":"12936001","system":"gprdproduct"},{"code":"3511007","system":"gprdproduct"},{"code":"794001","system":"gprdproduct"},{"code":"121001","system":"gprdproduct"},{"code":"11272001","system":"gprdproduct"},{"code":"5739002","system":"gprdproduct"},{"code":"8911002","system":"gprdproduct"},{"code":"1022003","system":"gprdproduct"},{"code":"6697003","system":"gprdproduct"},{"code":"89001","system":"gprdproduct"},{"code":"5707009","system":"gprdproduct"},{"code":"1666009","system":"gprdproduct"},{"code":"1281001","system":"gprdproduct"},{"code":"12891001","system":"gprdproduct"},{"code":"5467001","system":"gprdproduct"},{"code":"2221001","system":"gprdproduct"},{"code":"8630001","system":"gprdproduct"},{"code":"3268003","system":"gprdproduct"},{"code":"12069001","system":"gprdproduct"},{"code":"3966001","system":"gprdproduct"},{"code":"126009","system":"gprdproduct"},{"code":"8612001","system":"gprdproduct"},{"code":"12722001","system":"gprdproduct"},{"code":"170007","system":"gprdproduct"},{"code":"7156001","system":"gprdproduct"},{"code":"1021001","system":"gprdproduct"},{"code":"6044001","system":"gprdproduct"},{"code":"12009001","system":"gprdproduct"},{"code":"5705009","system":"gprdproduct"},{"code":"2901009","system":"gprdproduct"},{"code":"2137001","system":"gprdproduct"},{"code":"2139009","system":"gprdproduct"},{"code":"4015001","system":"gprdproduct"},{"code":"6817001","system":"gprdproduct"},{"code":"14962001","system":"gprdproduct"},{"code":"606011","system":"gprdproduct"},{"code":"4463009","system":"gprdproduct"},{"code":"6916002","system":"gprdproduct"},{"code":"604011","system":"gprdproduct"},{"code":"7244001","system":"gprdproduct"},{"code":"7714001","system":"gprdproduct"},{"code":"5366007","system":"gprdproduct"},{"code":"5704009","system":"gprdproduct"},{"code":"9072001","system":"gprdproduct"},{"code":"5759009","system":"gprdproduct"},{"code":"3869009","system":"gprdproduct"},{"code":"6016002","system":"gprdproduct"},{"code":"2608002","system":"gprdproduct"},{"code":"2300001","system":"gprdproduct"},{"code":"5710009","system":"gprdproduct"},{"code":"11642001","system":"gprdproduct"},{"code":"4428009","system":"gprdproduct"},{"code":"6943003","system":"gprdproduct"},{"code":"10878001","system":"gprdproduct"},{"code":"11995001","system":"gprdproduct"},{"code":"8828001","system":"gprdproduct"},{"code":"123001","system":"gprdproduct"},{"code":"4015002","system":"gprdproduct"},{"code":"4014001","system":"gprdproduct"},{"code":"6735001","system":"gprdproduct"},{"code":"14940001","system":"gprdproduct"},{"code":"8380001","system":"gprdproduct"},{"code":"5056001","system":"gprdproduct"},{"code":"5150001","system":"gprdproduct"},{"code":"7099001","system":"gprdproduct"},{"code":"8843001","system":"gprdproduct"},{"code":"3966002","system":"gprdproduct"},{"code":"8552001","system":"gprdproduct"},{"code":"8596003","system":"gprdproduct"},{"code":"4785002","system":"gprdproduct"},{"code":"4814002","system":"gprdproduct"},{"code":"168007","system":"gprdproduct"},{"code":"5372002","system":"gprdproduct"},{"code":"14551001","system":"gprdproduct"},{"code":"4786002","system":"gprdproduct"},{"code":"3910001","system":"gprdproduct"},{"code":"11475002","system":"gprdproduct"},{"code":"8688001","system":"gprdproduct"},{"code":"605010","system":"gprdproduct"},{"code":"12825001","system":"gprdproduct"},{"code":"1776001","system":"gprdproduct"},{"code":"10628001","system":"gprdproduct"},{"code":"11694001","system":"gprdproduct"},{"code":"1021002","system":"gprdproduct"},{"code":"12560001","system":"gprdproduct"},{"code":"2809009","system":"gprdproduct"},{"code":"1287001","system":"gprdproduct"},{"code":"3111007","system":"gprdproduct"},{"code":"2827003","system":"gprdproduct"},{"code":"6445009","system":"gprdproduct"},{"code":"6854009","system":"gprdproduct"},{"code":"2327001","system":"gprdproduct"},{"code":"171007","system":"gprdproduct"},{"code":"605009","system":"gprdproduct"},{"code":"6934001","system":"gprdproduct"},{"code":"8380003","system":"gprdproduct"},{"code":"2413001","system":"gprdproduct"},{"code":"12826001","system":"gprdproduct"},{"code":"1413001","system":"gprdproduct"},{"code":"10353001","system":"gprdproduct"},{"code":"2127003","system":"gprdproduct"},{"code":"14569005","system":"gprdproduct"},{"code":"59005","system":"gprdproduct"},{"code":"3267002","system":"gprdproduct"},{"code":"7099003","system":"gprdproduct"},{"code":"11657001","system":"gprdproduct"},{"code":"14565005","system":"gprdproduct"},{"code":"2746001","system":"gprdproduct"},{"code":"5616003","system":"gprdproduct"},{"code":"6315001","system":"gprdproduct"},{"code":"3164011","system":"gprdproduct"},{"code":"1409003","system":"gprdproduct"},{"code":"7297002","system":"gprdproduct"},{"code":"11700001","system":"gprdproduct"},{"code":"8596002","system":"gprdproduct"},{"code":"11897001","system":"gprdproduct"},{"code":"1830007","system":"gprdproduct"},{"code":"5544001","system":"gprdproduct"},{"code":"13503001","system":"gprdproduct"},{"code":"5058002","system":"gprdproduct"},{"code":"9582001","system":"gprdproduct"},{"code":"1953009","system":"gprdproduct"},{"code":"2878001","system":"gprdproduct"},{"code":"2338001","system":"gprdproduct"},{"code":"3889002","system":"gprdproduct"},{"code":"8842001","system":"gprdproduct"},{"code":"5465001","system":"gprdproduct"},{"code":"3265003","system":"gprdproduct"},{"code":"1340002","system":"gprdproduct"},{"code":"3341001","system":"gprdproduct"},{"code":"1112003","system":"gprdproduct"},{"code":"7236001","system":"gprdproduct"},{"code":"7154003","system":"gprdproduct"},{"code":"11565001","system":"gprdproduct"},{"code":"5058003","system":"gprdproduct"},{"code":"10713001","system":"gprdproduct"},{"code":"7588001","system":"gprdproduct"},{"code":"3419007","system":"gprdproduct"},{"code":"1018002","system":"gprdproduct"},{"code":"8636003","system":"gprdproduct"},{"code":"12008001","system":"gprdproduct"},{"code":"11477001","system":"gprdproduct"},{"code":"181007","system":"gprdproduct"},{"code":"14946001","system":"gprdproduct"},{"code":"12724001","system":"gprdproduct"},{"code":"8429002","system":"gprdproduct"},{"code":"6629002","system":"gprdproduct"},{"code":"14887001","system":"gprdproduct"},{"code":"2127001","system":"gprdproduct"},{"code":"9768005","system":"gprdproduct"},{"code":"6654001","system":"gprdproduct"},{"code":"2294009","system":"gprdproduct"},{"code":"6818003","system":"gprdproduct"},{"code":"743001","system":"gprdproduct"},{"code":"11509001","system":"gprdproduct"},{"code":"3266003","system":"gprdproduct"},{"code":"11507005","system":"gprdproduct"},{"code":"3889001","system":"gprdproduct"},{"code":"5933007","system":"gprdproduct"},{"code":"3867009","system":"gprdproduct"},{"code":"1020002","system":"gprdproduct"},{"code":"166002","system":"gprdproduct"},{"code":"927002","system":"gprdproduct"},{"code":"1560009","system":"gprdproduct"},{"code":"5589002","system":"gprdproduct"},{"code":"603009","system":"gprdproduct"},{"code":"9411001","system":"gprdproduct"},{"code":"2580007","system":"gprdproduct"},{"code":"14561005","system":"gprdproduct"},{"code":"2836001","system":"gprdproduct"},{"code":"3891007","system":"gprdproduct"},{"code":"2414001","system":"gprdproduct"},{"code":"1558010","system":"gprdproduct"},{"code":"5365007","system":"gprdproduct"},{"code":"4788001","system":"gprdproduct"},{"code":"4815003","system":"gprdproduct"},{"code":"2331005","system":"gprdproduct"},{"code":"126010","system":"gprdproduct"},{"code":"13469001","system":"gprdproduct"},{"code":"1403001","system":"gprdproduct"},{"code":"1561009","system":"gprdproduct"},{"code":"3974009","system":"gprdproduct"},{"code":"9319001","system":"gprdproduct"},{"code":"2319002","system":"gprdproduct"},{"code":"6933002","system":"gprdproduct"},{"code":"7269001","system":"gprdproduct"},{"code":"14169001","system":"gprdproduct"},{"code":"3373010","system":"gprdproduct"},{"code":"7155001","system":"gprdproduct"},{"code":"9056001","system":"gprdproduct"},{"code":"12890001","system":"gprdproduct"},{"code":"4812003","system":"gprdproduct"},{"code":"5363001","system":"gprdproduct"},{"code":"5557003","system":"gprdproduct"},{"code":"14937001","system":"gprdproduct"},{"code":"13502001","system":"gprdproduct"},{"code":"7288002","system":"gprdproduct"},{"code":"745001","system":"gprdproduct"},{"code":"13198001","system":"gprdproduct"},{"code":"4816001","system":"gprdproduct"},{"code":"13008001","system":"gprdproduct"},{"code":"10939001","system":"gprdproduct"},{"code":"6696003","system":"gprdproduct"},{"code":"2514002","system":"gprdproduct"},{"code":"2914002","system":"gprdproduct"},{"code":"604009","system":"gprdproduct"},{"code":"3897009","system":"gprdproduct"},{"code":"14963001","system":"gprdproduct"},{"code":"1195001","system":"gprdproduct"},{"code":"2744011","system":"gprdproduct"},{"code":"4016001","system":"gprdproduct"},{"code":"2177009","system":"gprdproduct"},{"code":"12020001","system":"gprdproduct"},{"code":"5369007","system":"gprdproduct"},{"code":"10723001","system":"gprdproduct"},{"code":"5616001","system":"gprdproduct"},{"code":"11529001","system":"gprdproduct"},{"code":"3266002","system":"gprdproduct"},{"code":"1022001","system":"gprdproduct"},{"code":"5709009","system":"gprdproduct"},{"code":"2847009","system":"gprdproduct"},{"code":"5159001","system":"gprdproduct"},{"code":"3114009","system":"gprdproduct"},{"code":"7100002","system":"gprdproduct"},{"code":"6916001","system":"gprdproduct"},{"code":"3269001","system":"gprdproduct"},{"code":"12892001","system":"gprdproduct"},{"code":"1776002","system":"gprdproduct"},{"code":"5936007","system":"gprdproduct"},{"code":"5166001","system":"gprdproduct"},{"code":"6559001","system":"gprdproduct"},{"code":"3596002","system":"gprdproduct"},{"code":"3209009","system":"gprdproduct"},{"code":"6933001","system":"gprdproduct"},{"code":"605011","system":"gprdproduct"},{"code":"4693001","system":"gprdproduct"},{"code":"121003","system":"gprdproduct"},{"code":"9605002","system":"gprdproduct"},{"code":"6315002","system":"gprdproduct"},{"code":"5592002","system":"gprdproduct"},{"code":"14947001","system":"gprdproduct"},{"code":"3888002","system":"gprdproduct"},{"code":"4820001","system":"gprdproduct"},{"code":"10137002","system":"gprdproduct"},{"code":"5058001","system":"gprdproduct"},{"code":"12121001","system":"gprdproduct"},{"code":"5594007","system":"gprdproduct"},{"code":"4927001","system":"gprdproduct"},{"code":"281001","system":"gprdproduct"},{"code":"13678001","system":"gprdproduct"},{"code":"1065001","system":"gprdproduct"},{"code":"182007","system":"gprdproduct"},{"code":"6818002","system":"gprdproduct"},{"code":"4324001","system":"gprdproduct"},{"code":"849001","system":"gprdproduct"},{"code":"12874001","system":"gprdproduct"},{"code":"7714002","system":"gprdproduct"},{"code":"1149001","system":"gprdproduct"},{"code":"2482001","system":"gprdproduct"},{"code":"6943002","system":"gprdproduct"},{"code":"5800001","system":"gprdproduct"},{"code":"6378007","system":"gprdproduct"},{"code":"3323001","system":"gprdproduct"},{"code":"9121001","system":"gprdproduct"},{"code":"11166001","system":"gprdproduct"},{"code":"865002","system":"gprdproduct"},{"code":"7275001","system":"gprdproduct"},{"code":"11519002","system":"gprdproduct"},{"code":"2581007","system":"gprdproduct"},{"code":"11474003","system":"gprdproduct"},{"code":"3886001","system":"gprdproduct"},{"code":"1827007","system":"gprdproduct"},{"code":"4016003","system":"gprdproduct"},{"code":"604010","system":"gprdproduct"},{"code":"996002","system":"gprdproduct"},{"code":"1340003","system":"gprdproduct"},{"code":"8651001","system":"gprdproduct"},{"code":"5055001","system":"gprdproduct"},{"code":"11512001","system":"gprdproduct"},{"code":"10760001","system":"gprdproduct"},{"code":"6058002","system":"gprdproduct"},{"code":"2744010","system":"gprdproduct"},{"code":"8452001","system":"gprdproduct"},{"code":"1791009","system":"gprdproduct"},{"code":"10652001","system":"gprdproduct"},{"code":"1829007","system":"gprdproduct"},{"code":"77009","system":"gprdproduct"},{"code":"2319001","system":"gprdproduct"},{"code":"3064009","system":"gprdproduct"},{"code":"865001","system":"gprdproduct"},{"code":"7297001","system":"gprdproduct"},{"code":"2536001","system":"gprdproduct"},{"code":"4507001","system":"gprdproduct"},{"code":"3263001","system":"gprdproduct"},{"code":"5412009","system":"gprdproduct"},{"code":"11648003","system":"gprdproduct"},{"code":"948001","system":"gprdproduct"},{"code":"1047002","system":"gprdproduct"},{"code":"6817003","system":"gprdproduct"},{"code":"2032009","system":"gprdproduct"},{"code":"5442002","system":"gprdproduct"},{"code":"6698009","system":"gprdproduct"},{"code":"5302007","system":"gprdproduct"},{"code":"14888001","system":"gprdproduct"},{"code":"12011002","system":"gprdproduct"},{"code":"2746002","system":"gprdproduct"},{"code":"3324001","system":"gprdproduct"},{"code":"4249001","system":"gprdproduct"},{"code":"8636002","system":"gprdproduct"},{"code":"4818001","system":"gprdproduct"},{"code":"6452009","system":"gprdproduct"},{"code":"8580001","system":"gprdproduct"},{"code":"4814001","system":"gprdproduct"},{"code":"2835001","system":"gprdproduct"},{"code":"12934001","system":"gprdproduct"},{"code":"1020003","system":"gprdproduct"},{"code":"8664001","system":"gprdproduct"},{"code":"7526003","system":"gprdproduct"},{"code":"120002","system":"gprdproduct"},{"code":"12486001","system":"gprdproduct"},{"code":"4813003","system":"gprdproduct"},{"code":"6913007","system":"gprdproduct"},{"code":"6016001","system":"gprdproduct"},{"code":"1832009","system":"gprdproduct"},{"code":"3970009","system":"gprdproduct"},{"code":"5374001","system":"gprdproduct"},{"code":"1398001","system":"gprdproduct"},{"code":"12873001","system":"gprdproduct"},{"code":"11475001","system":"gprdproduct"},{"code":"4507002","system":"gprdproduct"},{"code":"6245007","system":"gprdproduct"},{"code":"796002","system":"gprdproduct"},{"code":"9580001","system":"gprdproduct"},{"code":"2049001","system":"gprdproduct"},{"code":"5589001","system":"gprdproduct"},{"code":"1287002","system":"gprdproduct"},{"code":"7800001","system":"gprdproduct"},{"code":"9070001","system":"gprdproduct"},{"code":"1558011","system":"gprdproduct"},{"code":"9844005","system":"gprdproduct"},{"code":"2728005","system":"gprdproduct"},{"code":"1832010","system":"gprdproduct"},{"code":"3342001","system":"gprdproduct"},{"code":"3509007","system":"gprdproduct"},{"code":"3446002","system":"gprdproduct"},{"code":"6696001","system":"gprdproduct"},{"code":"9822001","system":"gprdproduct"},{"code":"11501005","system":"gprdproduct"},{"code":"3322003","system":"gprdproduct"},{"code":"1189001","system":"gprdproduct"},{"code":"8654001","system":"gprdproduct"},{"code":"3061009","system":"gprdproduct"},{"code":"2032010","system":"gprdproduct"},{"code":"8602001","system":"gprdproduct"},{"code":"5138002","system":"gprdproduct"},{"code":"2904005","system":"gprdproduct"},{"code":"5440002","system":"gprdproduct"},{"code":"6267002","system":"gprdproduct"},{"code":"14958001","system":"gprdproduct"},{"code":"849002","system":"gprdproduct"},{"code":"1711001","system":"gprdproduct"},{"code":"6542001","system":"gprdproduct"},{"code":"2241001","system":"gprdproduct"},{"code":"3059007","system":"gprdproduct"},{"code":"7243001","system":"gprdproduct"},{"code":"5748005","system":"gprdproduct"},{"code":"5466002","system":"gprdproduct"},{"code":"169007","system":"gprdproduct"},{"code":"3342002","system":"gprdproduct"},{"code":"603011","system":"gprdproduct"},{"code":"3596001","system":"gprdproduct"},{"code":"5414009","system":"gprdproduct"},{"code":"4506002","system":"gprdproduct"},{"code":"5442001","system":"gprdproduct"},{"code":"5364007","system":"gprdproduct"},{"code":"2482002","system":"gprdproduct"},{"code":"5159002","system":"gprdproduct"},{"code":"10414001","system":"gprdproduct"},{"code":"3445001","system":"gprdproduct"},{"code":"14886001","system":"gprdproduct"},{"code":"7526001","system":"gprdproduct"},{"code":"9605001","system":"gprdproduct"},{"code":"6444009","system":"gprdproduct"},{"code":"1194001","system":"gprdproduct"},{"code":"6942003","system":"gprdproduct"},{"code":"8911001","system":"gprdproduct"},{"code":"14945001","system":"gprdproduct"},{"code":"11647001","system":"gprdproduct"},{"code":"11910001","system":"gprdproduct"},{"code":"794002","system":"gprdproduct"},{"code":"14938001","system":"gprdproduct"},{"code":"6629001","system":"gprdproduct"},{"code":"4785001","system":"gprdproduct"},{"code":"10137003","system":"gprdproduct"},{"code":"3868009","system":"gprdproduct"},{"code":"4835009","system":"gprdproduct"},{"code":"2702005","system":"gprdproduct"},{"code":"8727001","system":"gprdproduct"},{"code":"12105001","system":"gprdproduct"},{"code":"7276001","system":"gprdproduct"},{"code":"11648001","system":"gprdproduct"},{"code":"122001","system":"gprdproduct"},{"code":"682001","system":"gprdproduct"},{"code":"3341002","system":"gprdproduct"},{"code":"663001","system":"gprdproduct"},{"code":"5467003","system":"gprdproduct"},{"code":"1020001","system":"gprdproduct"},{"code":"6817002","system":"gprdproduct"},{"code":"5958001","system":"gprdproduct"},{"code":"707005","system":"gprdproduct"},{"code":"8609001","system":"gprdproduct"},{"code":"8665001","system":"gprdproduct"},{"code":"4016002","system":"gprdproduct"},{"code":"5441003","system":"gprdproduct"},{"code":"4937001","system":"gprdproduct"},{"code":"4817001","system":"gprdproduct"},{"code":"5742009","system":"gprdproduct"},{"code":"5153001","system":"gprdproduct"},{"code":"3373009","system":"gprdproduct"},{"code":"5153002","system":"gprdproduct"},{"code":"5543002","system":"gprdproduct"},{"code":"8689001","system":"gprdproduct"},{"code":"85002","system":"gprdproduct"},{"code":"3446001","system":"gprdproduct"},{"code":"5371001","system":"gprdproduct"},{"code":"106001","system":"gprdproduct"},{"code":"13218001","system":"gprdproduct"},{"code":"1405001","system":"gprdproduct"},{"code":"4670005","system":"gprdproduct"},{"code":"5442003","system":"gprdproduct"},{"code":"15470005","system":"gprdproduct"},{"code":"12402001","system":"gprdproduct"},{"code":"9582002","system":"gprdproduct"},{"code":"2827002","system":"gprdproduct"},{"code":"6696002","system":"gprdproduct"},{"code":"10484001","system":"gprdproduct"},{"code":"8608001","system":"gprdproduct"},{"code":"12894001","system":"gprdproduct"},{"code":"3574009","system":"gprdproduct"},{"code":"5336001","system":"gprdproduct"},{"code":"9366001","system":"gprdproduct"},{"code":"3886002","system":"gprdproduct"},{"code":"1022002","system":"gprdproduct"},{"code":"6588007","system":"gprdproduct"},{"code":"4787001","system":"gprdproduct"},{"code":"7100003","system":"gprdproduct"},{"code":"927001","system":"gprdproduct"},{"code":"2260005","system":"gprdproduct"},{"code":"1112002","system":"gprdproduct"},{"code":"2993009","system":"gprdproduct"},{"code":"12506001","system":"gprdproduct"},{"code":"5557001","system":"gprdproduct"},{"code":"11726001","system":"gprdproduct"},{"code":"1024002","system":"gprdproduct"},{"code":"7100001","system":"gprdproduct"},{"code":"10589001","system":"gprdproduct"},{"code":"4812001","system":"gprdproduct"},{"code":"1419001","system":"gprdproduct"},{"code":"5739003","system":"gprdproduct"},{"code":"4324002","system":"gprdproduct"},{"code":"1411001","system":"gprdproduct"},{"code":"4061001","system":"gprdproduct"},{"code":"2413002","system":"gprdproduct"},{"code":"2729005","system":"gprdproduct"},{"code":"2665001","system":"gprdproduct"},{"code":"5470001","system":"gprdproduct"},{"code":"14941001","system":"gprdproduct"},{"code":"5303007","system":"gprdproduct"},{"code":"3887001","system":"gprdproduct"},{"code":"9583002","system":"gprdproduct"},{"code":"14175001","system":"gprdproduct"},{"code":"11793005","system":"gprdproduct"},{"code":"2221002","system":"gprdproduct"},{"code":"7157001","system":"gprdproduct"},{"code":"4819001","system":"gprdproduct"},{"code":"949001","system":"gprdproduct"},{"code":"166001","system":"gprdproduct"},{"code":"8062001","system":"gprdproduct"},{"code":"7157002","system":"gprdproduct"},{"code":"10821001","system":"gprdproduct"},{"code":"8714001","system":"gprdproduct"},{"code":"1558009","system":"gprdproduct"},{"code":"5711009","system":"gprdproduct"},{"code":"3164010","system":"gprdproduct"},{"code":"3888001","system":"gprdproduct"},{"code":"2878002","system":"gprdproduct"},{"code":"8911003","system":"gprdproduct"},{"code":"3446007","system":"gprdproduct"},{"code":"4936001","system":"gprdproduct"},{"code":"1409001","system":"gprdproduct"},{"code":"5375001","system":"gprdproduct"},{"code":"5440003","system":"gprdproduct"},{"code":"4013001","system":"gprdproduct"},{"code":"3268002","system":"gprdproduct"},{"code":"1283001","system":"gprdproduct"},{"code":"1018003","system":"gprdproduct"},{"code":"12937001","system":"gprdproduct"},{"code":"3418007","system":"gprdproduct"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('asthma-drugs-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["asthma-drugs---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["asthma-drugs---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["asthma-drugs---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
